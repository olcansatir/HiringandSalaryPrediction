<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>238310addbe14a86a87cd71eff8c65c6</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="ValT2ElxAdx1">
<hr />
<h1 id="hiring-and-salary-prediction-using-machine-learning"><font color='red'>HIRING AND SALARY PREDICTION USING MACHINE LEARNING</font></h1>
<hr />
<p># <div style="font-size:50px"><p> <pre>OLÇAN SATIR</pre></p></p>
</div>
<section id="1introduction" class="cell markdown" id="f5husMCA38Kb">
<h1><strong>1.INTRODUCTION</strong></h1>
<p>The fact that today's growing economies and the globalizing world have to go down with threats such as pandemics, and these threats are predicted to continue in the coming decades, and the unstable economic policies of governments and the inflation problem around the world have made it necessary for companies to be very careful in hiring personnel. They try newly developed methods in order to increase recruitment rigor and act with merit. Perhaps the most important of these methods is to use artificial intelligence methods, which have become very popular in recent years.</p>
<p>We all know how important data is today. Here we process this precious metal with various tools and transform it into systems that can make automatic predictions with machine learning methods.</p>
<p>In this study, we can also use it for companies and to develop transparent recruitment methodologies, first visualize the recruitment data set on kaggle for various purposes and then use 6 different regressions and 4 different classification methods to make a classification about whether to be hired or not, and the prediction yearly salary for hired people. We have brought an existing salary recommendation for the algorithms. Among these algorithms, the most successful one for classification is KNeigbors classification with 86.2% percent and 86.2% for regression with Gradient Boosting Regressor.</p>
<p><em>Keywords:Recruitment , Machine Learning , Classification , Regression , Salary Prediction.</em></p>
</section>
<div class="cell markdown" id="uBVioNjXdvO6">
<h1 id="2related-works"><strong>2.RELATED WORKS</strong></h1>
<p>There have been a number of studies conducted in the field of recruitment using machine learning algorithms.</p>
<ul>
<li><p>In a study published in the journal "Expert Systems with Applications," researchers used machine learning algorithms to predict the success of job candidates based on data from their resumes and job descriptions. The study found that the machine learning models were able to accurately predict candidate success with an average precision of 87.5%.[1]</p></li>
<li><p>Another study, published in the journal "Computers in Human Behavior," used machine learning algorithms to analyze the language used in job advertisements and resumes in order to predict the success of job candidates. The study found that the machine learning models were able to accurately predict candidate success with an average precision of 82.9%.[2]</p></li>
<li><p>A third study, published in the journal "Personnel Psychology," used machine learning algorithms to analyze data on job candidates' personalities, skills, and other characteristics in order to predict their job performance. The study found that the machine learning models were able to accurately predict job performance with an average precision of 75%.[3]</p></li>
</ul>
<p>These are just a few examples of the studies that have been done in the field of recruitment using machine learning algorithms. It is worth noting that while machine learning can be a powerful tool for predicting candidate success and job performance, it is important to consider the limitations and potential biases of these algorithms, and to use them in conjunction with other methods of recruitment and evaluation.</p>
<h1 id="3dataset"><strong>3.DATASET</strong></h1>
<p>In this study, the Campus Recruitment[4] dataset on Kaggle was used. There are 15 features in the related dataset, whose names and definitions are given below, and 2 of these 15 features are target data for regression and classification.</p>
<p>Here is an overview of the dataset,</p>
<p><strong>1.sl_no :</strong> unique identifier of each student record</p>
<p><strong>2.gender :</strong> Male='M',Female='F'</p>
<p><strong>3.ssc_p :</strong> Secondary Education percentage</p>
<p><strong>4.ssc_b :</strong> Secondary Education Board(Central or Others)</p>
<p><strong>5.hsc_p :</strong> Higher Secondary Education percentage</p>
<p><strong>6.hsc_b :</strong> Higher Secondary Education Board(Central or Others)</p>
<p><strong>7.hsc_s :</strong> Specialization in Higher Secondary Education (Commerce or Science or Others)</p>
<p><strong>8. degree_p :</strong> Degree Percentage</p>
<p><strong>9. degree_t :</strong>Degree Type or specialisation (Comm&amp;Mgmt, Sci&amp;Tech, Other)</p>
<p><strong>10. workex :</strong> Has prior work experience or not (yes/no)</p>
<p><strong>11. etest_p :</strong> Employability test percentage (conducted prior to Placements)</p>
<p><strong>12.specilisation :</strong> MBA Specialization (Mkt&amp;Fin or Mkt&amp;HR)</p>
<p><strong>13. mba_p :</strong> MBA percentage</p>
<p><strong>14.status :</strong> Status of placement (Placed or Notplaced)</p>
<p><strong>15.salary :</strong> Salary offered by corporate to placed students</p>
</div>
<section id="4data-preperati̇on-and-used-methodology" class="cell markdown" id="dLp2nC7Jcfjt">
<h1><strong>4.DATA PREPERATİON AND USED METHODOLOGY</strong></h1>
<p>In order to be able to work fluently on the data, we first had to make various arrangements on the data.</p>
<p>The first of these arrangements was to convert the string values in the data set to numerical data in order to facilitate the training of the data. For this, we converted the related strings into numerical values by using Label encoder on 3 features.</p>
<p>The second was to scale the data. We preferred a standard scaler for this. This operation subtracts the average of the values in the relevant category from the current value and scales these areas by dividing it by the variance.</p>
<p>Detailed description of the methodology used:</p>
<p><strong>Data Preprocessing</strong>: On the related data, we removed the null values that are not suitable for model training and converted the string values to numerical values with the label encoder.</p>
<p><strong>Feature Extraction</strong>: While training our model, we often paid attention to the correlation values for the 2 related target features and used these 2 values for regression and classification.</p>
<p><strong>Model Selection</strong>: In this study, 6 Regressions (Lineer, Gradient Boosting, kNN, Random Forest, Ridge , Losso) and 4 Classifications (kNN, Decision Tree, Gradient Boosting, Logistic) were used.</p>
<p><strong>Model Tuning</strong>: Grid-search was used on the algorithms for the optimization of the related models and the best values were selected for the training set.</p>
<p><strong>Evaluation</strong>: Finally, for the evaluation of the models, the r2 score was calculated and visualized in the regression models. For the classification, the recall, f1 and accuracy values were calculated and the confusion matrix was visualized.</p>
</section>
<div class="cell code" data-execution_count="1" id="5jt3W-moScrb">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Ridge, Lasso</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVR</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.gaussian_process <span class="im">import</span> GaussianProcessRegressor</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingRegressor</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report,confusion_matrix,accuracy_score</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm_notebook <span class="im">as</span> tqdm</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2" id="cedWey7kTXY2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;Placement_Data_Full_Class.csv&#39;</span>)</span></code></pre></div>
</div>
<section id="5exploratory-data-analysis" class="cell markdown" id="-goAd_uIJAm9">
<h1><strong>5.EXPLORATORY DATA ANALYSIS</strong></h1>
</section>
<div class="cell markdown" id="HZpf2af-I-PJ">
<p>First of all, we performed an exploratory data analysis to identify the data we will use in model training. In this analysis, the relationships and correlations of almost all features with each other were visualized. Seaborn and matplotlib libraries were used for these visualizations.</p>
</div>
<div class="cell code" data-execution_count="3" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="pF4aFccuTaAj" data-outputId="60e5f60e-63b8-4f3a-e9ff-b57939efe558">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">

  <div id="df-83c47397-0131-4ae1-83d1-f7a40c93cff3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sl_no</th>
      <th>gender</th>
      <th>ssc_p</th>
      <th>ssc_b</th>
      <th>hsc_p</th>
      <th>hsc_b</th>
      <th>hsc_s</th>
      <th>degree_p</th>
      <th>degree_t</th>
      <th>workex</th>
      <th>etest_p</th>
      <th>specialisation</th>
      <th>mba_p</th>
      <th>status</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>M</td>
      <td>67.00</td>
      <td>Others</td>
      <td>91.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>58.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>55.0</td>
      <td>Mkt&amp;HR</td>
      <td>58.80</td>
      <td>Placed</td>
      <td>270000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>79.33</td>
      <td>Central</td>
      <td>78.33</td>
      <td>Others</td>
      <td>Science</td>
      <td>77.48</td>
      <td>Sci&amp;Tech</td>
      <td>Yes</td>
      <td>86.5</td>
      <td>Mkt&amp;Fin</td>
      <td>66.28</td>
      <td>Placed</td>
      <td>200000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>M</td>
      <td>65.00</td>
      <td>Central</td>
      <td>68.00</td>
      <td>Central</td>
      <td>Arts</td>
      <td>64.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>75.0</td>
      <td>Mkt&amp;Fin</td>
      <td>57.80</td>
      <td>Placed</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>M</td>
      <td>56.00</td>
      <td>Central</td>
      <td>52.00</td>
      <td>Central</td>
      <td>Science</td>
      <td>52.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>66.0</td>
      <td>Mkt&amp;HR</td>
      <td>59.43</td>
      <td>Not Placed</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>M</td>
      <td>85.80</td>
      <td>Central</td>
      <td>73.60</td>
      <td>Central</td>
      <td>Commerce</td>
      <td>73.30</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>96.8</td>
      <td>Mkt&amp;Fin</td>
      <td>55.50</td>
      <td>Placed</td>
      <td>425000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>210</th>
      <td>211</td>
      <td>M</td>
      <td>80.60</td>
      <td>Others</td>
      <td>82.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>77.60</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>91.0</td>
      <td>Mkt&amp;Fin</td>
      <td>74.49</td>
      <td>Placed</td>
      <td>400000.0</td>
    </tr>
    <tr>
      <th>211</th>
      <td>212</td>
      <td>M</td>
      <td>58.00</td>
      <td>Others</td>
      <td>60.00</td>
      <td>Others</td>
      <td>Science</td>
      <td>72.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>74.0</td>
      <td>Mkt&amp;Fin</td>
      <td>53.62</td>
      <td>Placed</td>
      <td>275000.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>213</td>
      <td>M</td>
      <td>67.00</td>
      <td>Others</td>
      <td>67.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>73.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>Yes</td>
      <td>59.0</td>
      <td>Mkt&amp;Fin</td>
      <td>69.72</td>
      <td>Placed</td>
      <td>295000.0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>214</td>
      <td>F</td>
      <td>74.00</td>
      <td>Others</td>
      <td>66.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>58.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>70.0</td>
      <td>Mkt&amp;HR</td>
      <td>60.23</td>
      <td>Placed</td>
      <td>204000.0</td>
    </tr>
    <tr>
      <th>214</th>
      <td>215</td>
      <td>M</td>
      <td>62.00</td>
      <td>Central</td>
      <td>58.00</td>
      <td>Others</td>
      <td>Science</td>
      <td>53.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>89.0</td>
      <td>Mkt&amp;HR</td>
      <td>60.22</td>
      <td>Not Placed</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>215 rows × 15 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-83c47397-0131-4ae1-83d1-f7a40c93cff3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-83c47397-0131-4ae1-83d1-f7a40c93cff3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-83c47397-0131-4ae1-83d1-f7a40c93cff3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="4" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="kB76n5xPXvTe" data-outputId="4ac7380e-fde4-463c-c23b-e8458f539747">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;status&quot;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<pre><code>Placed        148
Not Placed     67
Name: status, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="t4vKwK4mWFAO" data-outputId="2d343d25-f98b-462b-954a-8c7312682eb6">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">

  <div id="df-3b1747f5-ca39-4dba-a887-94afec985b6e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sl_no</th>
      <th>gender</th>
      <th>ssc_p</th>
      <th>ssc_b</th>
      <th>hsc_p</th>
      <th>hsc_b</th>
      <th>hsc_s</th>
      <th>degree_p</th>
      <th>degree_t</th>
      <th>workex</th>
      <th>etest_p</th>
      <th>specialisation</th>
      <th>mba_p</th>
      <th>status</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>M</td>
      <td>67.00</td>
      <td>Others</td>
      <td>91.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>58.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>55.0</td>
      <td>Mkt&amp;HR</td>
      <td>58.80</td>
      <td>Placed</td>
      <td>270000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>79.33</td>
      <td>Central</td>
      <td>78.33</td>
      <td>Others</td>
      <td>Science</td>
      <td>77.48</td>
      <td>Sci&amp;Tech</td>
      <td>Yes</td>
      <td>86.5</td>
      <td>Mkt&amp;Fin</td>
      <td>66.28</td>
      <td>Placed</td>
      <td>200000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>M</td>
      <td>65.00</td>
      <td>Central</td>
      <td>68.00</td>
      <td>Central</td>
      <td>Arts</td>
      <td>64.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>75.0</td>
      <td>Mkt&amp;Fin</td>
      <td>57.80</td>
      <td>Placed</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>M</td>
      <td>56.00</td>
      <td>Central</td>
      <td>52.00</td>
      <td>Central</td>
      <td>Science</td>
      <td>52.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>66.0</td>
      <td>Mkt&amp;HR</td>
      <td>59.43</td>
      <td>Not Placed</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>M</td>
      <td>85.80</td>
      <td>Central</td>
      <td>73.60</td>
      <td>Central</td>
      <td>Commerce</td>
      <td>73.30</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>96.8</td>
      <td>Mkt&amp;Fin</td>
      <td>55.50</td>
      <td>Placed</td>
      <td>425000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>210</th>
      <td>211</td>
      <td>M</td>
      <td>80.60</td>
      <td>Others</td>
      <td>82.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>77.60</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>91.0</td>
      <td>Mkt&amp;Fin</td>
      <td>74.49</td>
      <td>Placed</td>
      <td>400000.0</td>
    </tr>
    <tr>
      <th>211</th>
      <td>212</td>
      <td>M</td>
      <td>58.00</td>
      <td>Others</td>
      <td>60.00</td>
      <td>Others</td>
      <td>Science</td>
      <td>72.00</td>
      <td>Sci&amp;Tech</td>
      <td>No</td>
      <td>74.0</td>
      <td>Mkt&amp;Fin</td>
      <td>53.62</td>
      <td>Placed</td>
      <td>275000.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>213</td>
      <td>M</td>
      <td>67.00</td>
      <td>Others</td>
      <td>67.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>73.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>Yes</td>
      <td>59.0</td>
      <td>Mkt&amp;Fin</td>
      <td>69.72</td>
      <td>Placed</td>
      <td>295000.0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>214</td>
      <td>F</td>
      <td>74.00</td>
      <td>Others</td>
      <td>66.00</td>
      <td>Others</td>
      <td>Commerce</td>
      <td>58.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>70.0</td>
      <td>Mkt&amp;HR</td>
      <td>60.23</td>
      <td>Placed</td>
      <td>204000.0</td>
    </tr>
    <tr>
      <th>214</th>
      <td>215</td>
      <td>M</td>
      <td>62.00</td>
      <td>Central</td>
      <td>58.00</td>
      <td>Others</td>
      <td>Science</td>
      <td>53.00</td>
      <td>Comm&amp;Mgmt</td>
      <td>No</td>
      <td>89.0</td>
      <td>Mkt&amp;HR</td>
      <td>60.22</td>
      <td>Not Placed</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>215 rows × 15 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3b1747f5-ca39-4dba-a887-94afec985b6e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3b1747f5-ca39-4dba-a887-94afec985b6e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3b1747f5-ca39-4dba-a887-94afec985b6e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="6" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="b1LLYsJuUyva" data-outputId="1cb62c7f-088d-4cb3-bc56-5900d0dc3f30">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.nunique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>sl_no             215
gender              2
ssc_p             103
ssc_b               2
hsc_p              97
hsc_b               2
hsc_s               3
degree_p           89
degree_t            3
workex              2
etest_p           100
specialisation      2
mba_p             205
status              2
salary             45
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="7" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="MU-S2BNKU1YO" data-outputId="1cada855-f12a-4b10-bbfd-2334de0ccd10">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 215 entries, 0 to 214
Data columns (total 15 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   sl_no           215 non-null    int64  
 1   gender          215 non-null    object 
 2   ssc_p           215 non-null    float64
 3   ssc_b           215 non-null    object 
 4   hsc_p           215 non-null    float64
 5   hsc_b           215 non-null    object 
 6   hsc_s           215 non-null    object 
 7   degree_p        215 non-null    float64
 8   degree_t        215 non-null    object 
 9   workex          215 non-null    object 
 10  etest_p         215 non-null    float64
 11  specialisation  215 non-null    object 
 12  mba_p           215 non-null    float64
 13  status          215 non-null    object 
 14  salary          148 non-null    float64
dtypes: float64(6), int64(1), object(8)
memory usage: 25.3+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="W9R7uMQnTols" data-outputId="96bcc237-04d0-48a3-9379-97f34182eadf">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Maximum salary: </span><span class="ch">\t</span><span class="st">${:0,.2f}&#39;</span>.<span class="bu">format</span>(df[<span class="st">&#39;salary&#39;</span>].<span class="bu">max</span>()))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Minimum salary: </span><span class="ch">\t</span><span class="st">${:0,.2f}&#39;</span>.<span class="bu">format</span>(df[<span class="st">&#39;salary&#39;</span>].<span class="bu">min</span>()))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Mean salary: </span><span class="ch">\t</span><span class="st">${:0,.2f}&#39;</span>.<span class="bu">format</span>(df[<span class="st">&#39;salary&#39;</span>].mean()))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Median salary: </span><span class="ch">\t</span><span class="st">${:0,.2f}&#39;</span>.<span class="bu">format</span>(df[<span class="st">&#39;salary&#39;</span>].median()))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Maximum salary: 	$940,000.00
Minimum salary: 	$200,000.00
Mean salary: 	$288,655.41
Median salary: 	$265,000.00
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9" data-colab="{&quot;height&quot;:584,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="XwHRaOOUSw-P" data-outputId="b2f07051-af91-48be-e638-667ae47265f6">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(),vmax<span class="op">=</span><span class="fl">1.0</span>,vmin<span class="op">=-</span><span class="fl">1.0</span>, square<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>            annot<span class="op">=</span><span class="va">True</span>, cbar_kws<span class="op">=</span>{<span class="st">&quot;shrink&quot;</span>: <span class="fl">.75</span>}, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/5666d54ea2395b1efb39c97a4ea97b7a3b7fe55c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="10" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="O9V4irzcTeRD" data-outputId="58e2837b-9679-4db2-a061-e39e5233d6c3">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;gender&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/c2603128263fa601d530e2827f2484d9a5e64e93.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="11" data-colab="{&quot;height&quot;:280,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0OIy_3soTgl8" data-outputId="016b72bb-cf75-460a-de1f-7fa7ff35ff0d">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;hsc_b&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/b73d1568d9ede21cd234ebc672a668564b773e6f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="12" data-colab="{&quot;height&quot;:297,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="V7OmGHePTiqv" data-outputId="c60e6932-c362-4c0b-f13c-236f52c60032">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;hsc_s&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8b63c1e670&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/738f07c25a87152003028fc847e4769cbd7e81e1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="13" data-colab="{&quot;height&quot;:297,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LmBtwATVTkYN" data-outputId="d9cf3bdc-dd0c-4a74-dc1d-1a0adb590196">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;degree_t&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8b63bebd90&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/95f0b9d0741b36d970b1d2e1d4e07eab0ab1abd1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="14" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="qm0m0jwuTmXz" data-outputId="0e07a037-edf6-4de1-c168-9f36465fe22e">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;sl_no&#39;</span>].nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>215</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15" data-colab="{&quot;height&quot;:300,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="bfU5_w4BTnue" data-outputId="bfa04567-415a-441f-865f-2cb19c3a1e27">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">

  <div id="df-cf21203f-14ea-4c90-8fd4-6f3494baa135">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sl_no</th>
      <th>ssc_p</th>
      <th>hsc_p</th>
      <th>degree_p</th>
      <th>etest_p</th>
      <th>mba_p</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>215.000000</td>
      <td>215.000000</td>
      <td>215.000000</td>
      <td>215.000000</td>
      <td>215.000000</td>
      <td>215.000000</td>
      <td>148.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>108.000000</td>
      <td>67.303395</td>
      <td>66.333163</td>
      <td>66.370186</td>
      <td>72.100558</td>
      <td>62.278186</td>
      <td>288655.405405</td>
    </tr>
    <tr>
      <th>std</th>
      <td>62.209324</td>
      <td>10.827205</td>
      <td>10.897509</td>
      <td>7.358743</td>
      <td>13.275956</td>
      <td>5.833385</td>
      <td>93457.452420</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>40.890000</td>
      <td>37.000000</td>
      <td>50.000000</td>
      <td>50.000000</td>
      <td>51.210000</td>
      <td>200000.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>54.500000</td>
      <td>60.600000</td>
      <td>60.900000</td>
      <td>61.000000</td>
      <td>60.000000</td>
      <td>57.945000</td>
      <td>240000.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>108.000000</td>
      <td>67.000000</td>
      <td>65.000000</td>
      <td>66.000000</td>
      <td>71.000000</td>
      <td>62.000000</td>
      <td>265000.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>161.500000</td>
      <td>75.700000</td>
      <td>73.000000</td>
      <td>72.000000</td>
      <td>83.500000</td>
      <td>66.255000</td>
      <td>300000.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>215.000000</td>
      <td>89.400000</td>
      <td>97.700000</td>
      <td>91.000000</td>
      <td>98.000000</td>
      <td>77.890000</td>
      <td>940000.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cf21203f-14ea-4c90-8fd4-6f3494baa135')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cf21203f-14ea-4c90-8fd4-6f3494baa135 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cf21203f-14ea-4c90-8fd4-6f3494baa135');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="16" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="J48Ftq_xTpqG" data-outputId="1deac86c-ed75-4a2b-868a-828ae7bde6e6">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;ssc_b&#39;</span>,col<span class="op">=</span><span class="st">&#39;gender&#39;</span>,hue<span class="op">=</span><span class="st">&#39;gender&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/c65b232a4f29371a2e515294f46c9006fe2f1d77.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="17" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="yZrIq9FjTtjS" data-outputId="129b3664-4e8f-403d-a53b-ce3a3d53b511">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;hsc_b&#39;</span>,col<span class="op">=</span><span class="st">&#39;gender&#39;</span>,hue<span class="op">=</span><span class="st">&#39;gender&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/931b6eafb6e2fda9f855f1b7e23e7b51cb4ba350.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="18" data-colab="{&quot;height&quot;:143,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zKNt5btzTu7j" data-outputId="6e1b8451-0424-4ff2-b8bc-c1186903d157">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">&#39;gender&#39;</span>])[<span class="st">&#39;ssc_p&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-f981ccf8-9598-47d3-8408-89028abca1dc">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>76.0</td>
      <td>68.310921</td>
      <td>11.522542</td>
      <td>40.89</td>
      <td>62.5</td>
      <td>69.75</td>
      <td>77.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>139.0</td>
      <td>66.752518</td>
      <td>10.429150</td>
      <td>41.00</td>
      <td>60.2</td>
      <td>65.00</td>
      <td>74.0</td>
      <td>89.4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f981ccf8-9598-47d3-8408-89028abca1dc')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f981ccf8-9598-47d3-8408-89028abca1dc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f981ccf8-9598-47d3-8408-89028abca1dc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="19" data-colab="{&quot;height&quot;:143,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="doSJWP-ATwNC" data-outputId="108a6cdd-084e-4d6b-ecaa-94f53e4f0fbb">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">&#39;gender&#39;</span>])[<span class="st">&#39;hsc_p&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">

  <div id="df-6015ec81-d67e-44a6-9683-c1e7e6b5940b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>76.0</td>
      <td>66.646842</td>
      <td>11.021048</td>
      <td>37.0</td>
      <td>60.0</td>
      <td>64.6</td>
      <td>73.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>139.0</td>
      <td>66.161655</td>
      <td>10.865579</td>
      <td>39.0</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>97.7</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6015ec81-d67e-44a6-9683-c1e7e6b5940b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6015ec81-d67e-44a6-9683-c1e7e6b5940b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6015ec81-d67e-44a6-9683-c1e7e6b5940b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="20" data-colab="{&quot;height&quot;:143,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="wopl2Hc5TxsT" data-outputId="5e49933d-f090-4a5b-d470-d49ee97a1246">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">&#39;gender&#39;</span>])[<span class="st">&#39;degree_p&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-9cb26396-f089-44d7-8c4b-503cd6dab9f5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>76.0</td>
      <td>68.090000</td>
      <td>8.128285</td>
      <td>50.2</td>
      <td>64.00</td>
      <td>67.7</td>
      <td>73.0</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>139.0</td>
      <td>65.429856</td>
      <td>6.748840</td>
      <td>50.0</td>
      <td>60.45</td>
      <td>65.0</td>
      <td>70.1</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9cb26396-f089-44d7-8c4b-503cd6dab9f5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9cb26396-f089-44d7-8c4b-503cd6dab9f5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9cb26396-f089-44d7-8c4b-503cd6dab9f5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="21" data-colab="{&quot;height&quot;:280,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="2Y7T7YSbTy6_" data-outputId="b4fb2519-2df6-4f25-c7ad-328b2932d790">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;ssc_b&#39;</span>,hue<span class="op">=</span><span class="st">&#39;status&#39;</span>,kde<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/a5f64da03b2a3b579cf51764222718ee36076ed7.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="22" data-colab="{&quot;height&quot;:297,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="pmLth6WzT18a" data-outputId="422ed612-4c9e-464a-a7e8-bc44f9b82e1c">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;degree_t&#39;</span>,hue<span class="op">=</span><span class="st">&#39;status&#39;</span>,kde<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8b619708b0&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/1744f503ea9509b6fc0131e81f20d65e2114ef22.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="23" data-colab="{&quot;height&quot;:280,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cFSM8o7kT38l" data-outputId="051907e9-b72b-401d-9f73-0175f743fd4c">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;mba_p&#39;</span>,y<span class="op">=</span><span class="st">&#39;degree_p&#39;</span>,hue<span class="op">=</span><span class="st">&#39;status&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/75fc81af41c203f13aafe10876ce0e17fbcc6c54.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="24" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Hw1UPGg3UFyb" data-outputId="7739010f-b9d4-4d25-e30c-ae5b8cedaf35">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;ssc_p&#39;</span>,y<span class="op">=</span><span class="st">&#39;hsc_p&#39;</span>,hue<span class="op">=</span><span class="st">&#39;status&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/35e617874e335260224b17fd5cc7513db167614c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="25" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="FUpO-sxY_yed" data-outputId="43dc9e5c-e831-41b4-8a4d-92b69093f95e">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;ssc_p&#39;</span>,y<span class="op">=</span><span class="st">&#39;mba_p&#39;</span>,hue<span class="op">=</span><span class="st">&#39;gender&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/7df8395a16e899490aedf753b7d7dbe7e5a9c47b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="26" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cwzdQHsD-WMv" data-outputId="65f6909f-2e59-42df-e7f9-86d5a7c649b7">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;etest_p&#39;</span>,y<span class="op">=</span><span class="st">&#39;hsc_p&#39;</span>,hue<span class="op">=</span><span class="st">&#39;workex&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/9c82c79b591ceb134fc1a1c236172b01b7f34fc7.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="27" data-colab="{&quot;height&quot;:309,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ldjV1Ud3WpPH" data-outputId="03e7db07-bd26-4801-cfb8-a5edebd7f105">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_id <span class="op">=</span> df.groupby(<span class="st">&#39;sl_no&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>).count()[[<span class="st">&#39;sl_no&#39;</span>]]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df_twice <span class="op">=</span> df_id.merge(df, on<span class="op">=</span><span class="st">&#39;sl_no&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>df_twice[<span class="st">&#39;salary&#39;</span>].hist(bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Salary (USD)&#39;</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Transactions&#39;</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/330dfa621b18dcfc7036d3febfcea20be1ad4cf8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="28" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="KWWGbqydT5rH" data-outputId="75bbd8e1-8b87-402c-cca2-23e1f93710ab">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(sns.FacetGrid(df, hue<span class="op">=</span><span class="st">&quot;status&quot;</span>,height<span class="op">=</span><span class="dv">5</span>,xlim<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">100</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>.<span class="bu">map</span>(sns.kdeplot,<span class="st">&quot;ssc_p&quot;</span>,shade<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>.add_legend()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/c364906198e570b5fbf97c86df8b722608fba636.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="29" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="5pO4OcmCT6-P" data-outputId="2022a222-b8a1-4ad4-96ae-c65224c763e1">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">&quot;ssc_p&quot;</span>,y<span class="op">=</span><span class="st">&quot;hsc_p&quot;</span>,data<span class="op">=</span>df)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/24cede9aa02857ef1d463b1fc7486c4ad1992848.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="30" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="NsPQvs1kUJKC" data-outputId="8c0a640b-110d-4806-e49f-763d7e394034">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">&quot;status&quot;</span>,y<span class="op">=</span><span class="st">&quot;hsc_p&quot;</span>,hue_order<span class="op">=</span><span class="st">&quot;color&quot;</span>, data<span class="op">=</span>df)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/a76ec1bd3a4fb08591d780e59f0b225b633087b9.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="31" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ziam7WL3UK-o" data-outputId="3d562513-4f56-4ff6-e107-1f07a77a7ba8">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&quot;status&quot;</span>,y<span class="op">=</span><span class="st">&quot;hsc_p&quot;</span>,hue<span class="op">=</span><span class="st">&quot;gender&quot;</span>,style<span class="op">=</span><span class="st">&quot;gender&quot;</span>,markers<span class="op">=</span><span class="va">True</span>,dashes<span class="op">=</span><span class="va">False</span>,data<span class="op">=</span>df)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/4a133094d0a70758fae6a33cb14ad005515bcf74.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="32" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="eEcFUjqpUOR8" data-outputId="c4bc068d-6312-4e86-c265-a7776597f827">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;mba_p&#39;</span>,y<span class="op">=</span><span class="st">&#39;status&#39;</span>,hue<span class="op">=</span><span class="st">&#39;status&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/8698ffb07f05e18d312447eba47b038c4ffdd99e.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="33" data-colab="{&quot;height&quot;:302,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="DPPabQQOUQWX" data-outputId="0e70d382-a035-4c41-8a45-01f12c02c454">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df.drop([<span class="st">&#39;sl_no&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>).corr()[<span class="st">&#39;salary&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/0fec428593affe40e51be89db78ec26504748f76.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="34" data-colab="{&quot;height&quot;:270,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="W4W22htTUR4u" data-outputId="8b08ea99-3400-470e-bd87-e3f9d7976b8b">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.drop([<span class="st">&#39;sl_no&#39;</span>,<span class="st">&#39;salary&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>).corr(),cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,annot<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/c929eed3ba342569d359b6fad12b0701fd934d92.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="35" data-colab="{&quot;height&quot;:369,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="z6f1Rj_sUUMF" data-outputId="f7584bf5-2b91-4c82-e930-e1d8f05d177e">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;hsc_s&#39;</span>,y<span class="op">=</span><span class="st">&#39;salary&#39;</span>,col<span class="op">=</span><span class="st">&#39;hsc_s&#39;</span>,hue<span class="op">=</span><span class="st">&#39;hsc_s&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/8a18b1dd1b83fcd55fd9edf038e76a74f39e8e72.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="36" data-colab="{&quot;height&quot;:280,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="WD-vxZWtUYtM" data-outputId="dd77cffc-bbb7-4fb2-e329-baed17e9ebe8">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;etest_p&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/d5da40ec8d5431927d597ae88e441050ae20bf4c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="37" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="AXhdLUXXUbH1" data-outputId="ca3c8fb6-1f0f-4bb7-d599-90564c349938">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;mba_p&quot;</span>].corr(df[<span class="st">&quot;salary&quot;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<pre><code>0.17501294069527482</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="xcEFOTWrUckg" data-outputId="fec66227-b0d3-4e17-9555-19aa5a5b8340">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;ssc_p&quot;</span>].corr(df[<span class="st">&quot;salary&quot;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<pre><code>0.03533034131020019</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Keqezn1eUjVE" data-outputId="66e12301-8b9c-4725-a5ba-8f45d353827d">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>degree_p1 <span class="op">=</span> pd.qcut(df[<span class="st">&quot;degree_p&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>df.pivot_table(<span class="st">&quot;salary&quot;</span>,index<span class="op">=</span>[<span class="st">&quot;status&quot;</span>,<span class="st">&quot;gender&quot;</span>], columns<span class="op">=</span>degree_p1, aggfunc<span class="op">=</span><span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">

  <div id="df-47a2bc7e-e8f1-4125-b4eb-fbbc411800f9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>degree_p</th>
      <th>(49.999, 64.0]</th>
      <th>(64.0, 69.0]</th>
      <th>(69.0, 91.0]</th>
    </tr>
    <tr>
      <th>status</th>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Not Placed</th>
      <th>F</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Placed</th>
      <th>F</th>
      <td>7</td>
      <td>17</td>
      <td>24</td>
    </tr>
    <tr>
      <th>M</th>
      <td>22</td>
      <td>41</td>
      <td>37</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-47a2bc7e-e8f1-4125-b4eb-fbbc411800f9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-47a2bc7e-e8f1-4125-b4eb-fbbc411800f9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-47a2bc7e-e8f1-4125-b4eb-fbbc411800f9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="40" data-colab="{&quot;height&quot;:325,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="hwrEpFdYUuSE" data-outputId="d801ed08-e130-4bcd-aeeb-626af06a2dea">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df.pivot_table(<span class="st">&quot;salary&quot;</span>, index<span class="op">=</span>[<span class="st">&quot;status&quot;</span>,<span class="st">&quot;gender&quot;</span>], columns<span class="op">=</span>degree_p1).plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/38b9ae23ee84359eeafbab607019c4179b273f59.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="41" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LOGp6gG8Uv0K" data-outputId="2ee10690-73c6-43f7-8436-40914611dc13">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;workex&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<pre><code>No     141
Yes     74
Name: workex, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="X-L1-s8DU-gN" data-outputId="410fff37-dc8f-47af-f389-6376136555ac">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;gender&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<pre><code>M    139
F     76
Name: gender, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="jLBHfDe1VCT9" data-outputId="f5088415-c728-434d-ac94-296ecb0419b1">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;salary&#39;</span>].mean()</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<pre><code>288655.4054054054</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44" data-colab="{&quot;height&quot;:1256,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="KmMW6EBKVGll" data-outputId="7327c848-f1af-4045-edc9-c47a3b4b634a">
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;ggplot&#39;</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">25</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;gender&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;gender&#39;</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;ssc_b&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;ssc_b&#39;</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;hsc_b&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;hsc_b&#39;</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;hsc_s&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;hsc_s&#39;</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;degree_t&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;degree_t&#39;</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;workex&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;workex&#39;</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">7</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;specialisation&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;specialisation&#39;</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">8</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;status&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,title<span class="op">=</span><span class="st">&#39;status&#39;</span>)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/5521db09820c37cc7f08fe14dda385345c979e54.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="45" data-colab="{&quot;height&quot;:518,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fyC1wyVRVJxY" data-outputId="13e205f3-97a8-4ce2-bcad-73559cdd3846">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.gender.value_counts())</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> <span class="st">&#39;Male&#39;</span>, <span class="st">&#39;Female&#39;</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>sizes <span class="op">=</span> [<span class="dv">207</span>, <span class="dv">96</span>]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>explode <span class="op">=</span> (<span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>ax1.pie(sizes, explode<span class="op">=</span>explode,colors <span class="op">=</span> [<span class="st">&quot;cyan&quot;</span>,<span class="st">&quot;magenta&quot;</span>], labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        shadow<span class="op">=</span><span class="va">True</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>ax1.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;&quot;</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>M    139
F     76
Name: gender, dtype: int64
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/31af6b2ea78aa3070a4f08b566dda7d42a5b3350.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="46" id="D1eRf9q2VT7C">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># label_encoder object knows how to understand word labels. </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> preprocessing.LabelEncoder() </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode labels in column &#39;species&#39;. </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;gender&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;gender&#39;</span>]) </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;ssc_b&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;ssc_b&#39;</span>]) </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;hsc_b&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;hsc_b&#39;</span>]) </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;hsc_s&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;hsc_s&#39;</span>]) </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;degree_t&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;degree_t&#39;</span>]) </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;specialisation&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;specialisation&#39;</span>]) </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;status&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;status&#39;</span>]) </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;workex&#39;</span>]<span class="op">=</span> label_encoder.fit_transform(df[<span class="st">&#39;workex&#39;</span>]) </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="47" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="JY-R3oIwq2hM" data-outputId="e5829dd8-7027-4435-edb1-df5125b312a6">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>pd.isnull(df).<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<pre><code>sl_no              0
gender             0
ssc_p              0
ssc_b              0
hsc_p              0
hsc_b              0
hsc_s              0
degree_p           0
degree_t           0
workex             0
etest_p            0
specialisation     0
mba_p              0
status             0
salary            67
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48" id="D_lP-PMYViIr">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;salary&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;salary&#39;</span>].fillna(<span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="49" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="H5ku6IJ2Z4in" data-outputId="b8dfb9f3-3c8f-423e-9a9c-4f7db998f44f">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df.nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="49">
<pre><code>sl_no             215
gender              2
ssc_p             103
ssc_b               2
hsc_p              97
hsc_b               2
hsc_s               3
degree_p           89
degree_t            3
workex              2
etest_p           100
specialisation      2
mba_p             205
status              2
salary             46
dtype: int64</code></pre>
</div>
</div>
<section id="6model-development-and-validation" class="cell markdown" id="uAXud55AhdBB">
<h2><strong>6.MODEL DEVELOPMENT AND VALIDATION</strong></h2>
</section>
<div class="cell code" data-execution_count="50" id="yoL3ZQBJVrkv">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&quot;salary&quot;</span>]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&quot;salary&quot;</span>,<span class="st">&quot;sl_no&quot;</span>])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="51" id="aBPuAnvuVyay">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Feature scalling</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>st_x<span class="op">=</span> StandardScaler()    </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span> st_x.fit_transform(X_train)    </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span> st_x.transform(X_test)  </span></code></pre></div>
</div>
<section id="61-regression" class="cell markdown" id="1VC8Hd05Ir5A">
<h2><strong>6.1 REGRESSION</strong></h2>
</section>
<div class="cell markdown" id="iXboQvJVimgv">
<p><strong>6.1.1 Gradient Boosting Regressor</strong></p>
<p>In this code, I am using grid search cross-validation to find the best hyperparameters for a gradient boosting regressor model. I define a dictionary of hyperparameters that i want to tune, with the keys being the hyperparameter names and the values being lists of possible values for each hyperparameter. I then pass this dictionary and the gradient boosting regressor model to the GridSearchCV function, which will train and evaluate a model for each possible combination of hyperparameters.</p>
<p>After fitting the grid search object to the training data, I can use the best_params_ attribute to access the best combination of hyperparameters found by the grid search. I then use this combination of hyperparameters to create a new gradient boosting regressor model, which I fit to the training data. Finally, I use this fitted model to make predictions on the test set and calculate the R^2 score, which is a measure of how well the model is able to predict the target variable. In this case, the R^2 score is 0.86215379, which means that the model was able to explain 86.2% of the variance in the test set.</p>
</div>
<div class="cell code" id="KY3KkKAaIvZ0">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {<span class="st">&quot;loss&quot;</span>: [<span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;absolute_error&#39;</span>, <span class="st">&#39;huber&#39;</span>, <span class="st">&#39;quantile&#39;</span>],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;max_features&quot;</span> : [<span class="st">&#39;auto&#39;</span>, <span class="st">&#39;sqrt&#39;</span>, <span class="st">&#39;log2&#39;</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;max_leaf_nodes&quot;</span> : [<span class="va">None</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">13</span>],</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;learning_rate&quot;</span>:[<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>grid_GBR <span class="op">=</span> GridSearchCV(GradientBoostingRegressor(),parameters)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>grid_GBR.fit(X_train, y_train)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>grid_GBR.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="53" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LbAS2B10LCHa" data-outputId="a07c28e9-c879-4896-aecd-19b79ba4f0b8">
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>best_GBR<span class="op">=</span>GradientBoostingRegressor(<span class="op">**</span>grid_GBR.best_params_)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>best_GBR.fit(X_train,y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="53">
<pre><code>GradientBoostingRegressor(loss=&#39;absolute_error&#39;, max_features=&#39;auto&#39;,
                          max_leaf_nodes=13)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="54" data-colab="{&quot;height&quot;:354,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="CO6lIqrXMVbc" data-outputId="f5d1e179-f1cb-4aa2-84e0-596feeb2bbfb">
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>pred_GBR <span class="op">=</span> best_GBR.predict(X_test)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_GBR)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>pred_GBR<span class="op">=</span> pred_GBR.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>y_test_gbr <span class="op">=</span> y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_gbr, best_GBR.fit(y_test_gbr, pred_GBR).predict(y_test_gbr))</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_gbr,  pred_GBR)))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/ensemble/_gb.py:494: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/dd872dfb85bbb4f153d5b376db6d71e3bb22a513.png" /></p>
</div>
</div>
<div class="cell markdown" id="SK4R8Foxjf2T">
<p><strong>6.1.2 KNeighbors Regressor</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my K-nearest neighbors regressor model. These hyperparameters are the number of neighbors to use, the weight function to use, and the power parameter for the Minkowski distance metric. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination, using 5-fold cross-validation.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new K-nearest neighbors regressor model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the R^2 score, which is a measure of how well the model was able to predict the target variable. The R^2 score was 0.67292706, which means that the model was able to explain 67.3% of the variance in the test set.</p>
</div>
<div class="cell code" data-execution_count="55" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="EnXSrqd9NG5f" data-outputId="b8640033-068d-4f7d-eff5-f3fb76ffb860">
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>parameters2 <span class="op">=</span> {<span class="st">&#39;n_neighbors&#39;</span>:[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>,<span class="st">&#39;distance&#39;</span>],<span class="st">&#39;p&#39;</span>:[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>]}</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>grid_KNN <span class="op">=</span> GridSearchCV(KNeighborsRegressor(), parameters2, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>grid_KNN.fit(X_train,y_train)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>grid_KNN.best_params_</span></code></pre></div>
<div class="output execute_result" data-execution_count="55">
<pre><code>{&#39;n_neighbors&#39;: 5, &#39;p&#39;: 5, &#39;weights&#39;: &#39;uniform&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Jq3cgRg6NhrM" data-outputId="5a606f39-fed7-4220-879b-514c11aad0fc">
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>best_KNN <span class="op">=</span> KNeighborsRegressor(<span class="op">**</span>grid_KNN.best_params_)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>best_KNN.fit(X_train,y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="56">
<pre><code>KNeighborsRegressor(p=5)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="57" data-colab="{&quot;height&quot;:299,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dikTZUZdNhs1" data-outputId="22be2f57-726a-48c8-f8f1-eec702840ded">
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pred_KNN <span class="op">=</span> best_KNN.predict(X_test)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_GBR)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>pred_KNN<span class="op">=</span> pred_KNN.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>y_test_knn <span class="op">=</span>  y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_knn, best_KNN.fit(y_test_knn, pred_KNN).predict(y_test_knn))</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_knn,  pred_KNN)))</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/205d51bd44fee49bb223f0d4b786183b703f91c1.png" /></p>
</div>
</div>
<div class="cell markdown" id="jZyTrAjDk48b">
<p><strong>6.1.3 Random Forest Regressor</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my random forest regressor model. These hyperparameters are the number of trees in the forest and the maximum depth of each tree. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination, using 3-fold cross-validation. I also specified that I wanted to use negative mean squared error as the scoring metric and set the verbosity level to 3, which means that the grid search will print out progress messages for each combination of hyperparameters that it evaluates.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new random forest regressor model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the R^2 score, which is a measure of how well the model was able to predict the target variable. The R^2 score was 0.85507292, which means that the model was able to explain 85.5% of the variance in the test set.</p>
</div>
<div class="cell code" id="5SjQCLZqOwvy">
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>parameters4 <span class="op">=</span> {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">300</span>],</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>grid_RFG <span class="op">=</span> GridSearchCV(RandomForestRegressor(),parameters4,scoring<span class="op">=</span><span class="st">&#39;neg_mean_squared_error&#39;</span>,cv<span class="op">=</span><span class="dv">3</span>,verbose<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>grid_RFG.fit(X_train,y_train)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>grid_RFG.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="59" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Nb4xNmHrQM0D" data-outputId="bcbfb9da-e200-4c59-b5c1-36ead6f951c1">
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>best_RFG <span class="op">=</span> RandomForestRegressor(<span class="op">**</span>grid_RFG.best_params_)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>best_RFG.fit(X_train,y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="59">
<pre><code>RandomForestRegressor(max_depth=1, n_estimators=200)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="60" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="m9t0_X9LOxJg" data-outputId="28c314fe-7122-411a-bcd0-5e4f900b4bbf">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>pred_RFG <span class="op">=</span> best_RFG.predict(X_test)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_GBR)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>pred_RFG<span class="op">=</span> pred_RFG.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>y_test_rfg <span class="op">=</span>  y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_rfg, best_RFG.fit(y_test_rfg, pred_RFG).predict(y_test_rfg))</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_rfg,  pred_RFG)))</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-60-9533bb06f1e4&gt;:10: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  ax.plot(y_test_rfg, best_RFG.fit(y_test_rfg, pred_RFG).predict(y_test_rfg))
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/43deb040eca95f53d466a533d75fb5ad43266da7.png" /></p>
</div>
</div>
<div class="cell markdown" id="gazVLv8CQfaq">
<p><strong>6.1.4 Linear Regression</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my linear regression model. These hyperparameters are the copy_X parameter, which determines whether the input data should be copied; the fit_intercept parameter, which determines whether the model should include an intercept term; the positive parameter, which specifies whether the coefficients of the model should be constrained to be non-negative; and the n_jobs parameter, which specifies the number of jobs to use for the computation. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination, using 5-fold cross-validation.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new linear regression model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the R^2 score, which is a measure of how well the model was able to predict the target variable. The R^2 score was 0.83036113, which means that the model was able to explain 83% of the variance in the test set.</p>
</div>
<div class="cell code" data-execution_count="61" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="UHIHFXyUN3S6" data-outputId="d4c47baa-9d5f-47b0-c748-6c4a09f9ff4d">
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>parameters5 <span class="op">=</span> {<span class="st">&quot;copy_X&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;fit_intercept&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;positive&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;n_jobs&quot;</span>: np.arange(<span class="dv">1</span>,<span class="dv">5</span>)}</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>grid_LR<span class="op">=</span>GridSearchCV(LinearRegression(),parameters5,cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>grid_LR.fit(X_train,y_train)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>grid_LR.best_params_</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>{&#39;copy_X&#39;: True, &#39;fit_intercept&#39;: True, &#39;n_jobs&#39;: 1, &#39;positive&#39;: True}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="MJHKMrghNG7n" data-outputId="6aed8f4a-f173-4b2a-e0b6-e9366c883550">
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>best_LR <span class="op">=</span> LinearRegression(<span class="op">**</span>grid_LR.best_params_)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>best_LR.fit(X_train,y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="62">
<pre><code>LinearRegression(n_jobs=1, positive=True)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="63" data-colab="{&quot;height&quot;:299,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="xCGyPWFoNG9y" data-outputId="447af502-d0cc-4ba1-d1a0-c9957a5af7d4">
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>pred_LR <span class="op">=</span> best_LR.predict(X_test)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_GBR)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>pred_LR<span class="op">=</span> pred_LR.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>y_test_lr <span class="op">=</span> y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_lr,best_LR.fit(y_test_lr, pred_LR).predict(y_test_lr))</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_lr,  pred_LR)))</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/df6d96fe31d445543a5e0369f32fbf4a2cf3935e.png" /></p>
</div>
</div>
<div class="cell markdown" id="efyXAzjuS13p">
<p><strong>6.1.5 Ridge</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my linear regression model. These hyperparameters are the flag to specify whether the input data should be copied, the flag to specify whether the model should fit an intercept term, the flag to specify whether the model should enforce positive coefficients, and the number of jobs to run in parallel. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination, using 5-fold cross-validation.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new linear regression model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the R^2 score, which is a measure of how well the model was able to predict the target variable. The R^2 score was 0.79661473, which means that the model was able to explain 79.7% of the variance in the test set.</p>
</div>
<div class="cell code" data-execution_count="64" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zlrEfVUKS1fI" data-outputId="0e35a37f-a5bf-4d83-df48-e6528ef330ab">
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>parameters6 <span class="op">=</span> {<span class="st">&#39;alpha&#39;</span>: [<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>,<span class="dv">0</span>] , <span class="st">&quot;fit_intercept&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>], <span class="st">&quot;solver&quot;</span>: [<span class="st">&#39;svd&#39;</span>, <span class="st">&#39;cholesky&#39;</span>, <span class="st">&#39;lsqr&#39;</span>, <span class="st">&#39;sparse_cg&#39;</span>, <span class="st">&#39;sag&#39;</span>, <span class="st">&#39;saga&#39;</span>]}</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>grid_Ridge<span class="op">=</span>GridSearchCV(Ridge(),parameters6,n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>grid_Ridge.fit(X_train,y_train)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>grid_Ridge.best_params_</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<pre><code>{&#39;alpha&#39;: 1, &#39;fit_intercept&#39;: True, &#39;solver&#39;: &#39;saga&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="20Zh6teBTPKb" data-outputId="74787307-6d7a-462b-d0ad-150f0be1d50e">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>best_Ridge <span class="op">=</span> Ridge(<span class="op">**</span>grid_Ridge.best_params_)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>best_Ridge.fit(X_train,y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="65">
<pre><code>Ridge(alpha=1, solver=&#39;saga&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="66" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="yu_vuDctTX-_" data-outputId="a8c173e1-87d3-4c08-e502-e2f74dae20f9">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pred_Ridge<span class="op">=</span>best_Ridge.predict(X_test)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_Ridge)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>pred_Ridge<span class="op">=</span> pred_Ridge.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>y_test_ridge <span class="op">=</span>  y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_ridge, best_RFG.fit(y_test_ridge, pred_Ridge).predict(y_test_ridge))</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_ridge,  pred_Ridge)))</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-66-666b83732081&gt;:10: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  ax.plot(y_test_ridge, best_RFG.fit(y_test_ridge, pred_Ridge).predict(y_test_ridge))
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/1d8d17611494a862c8501b74b3a60ef2930dafc0.png" /></p>
</div>
</div>
<div class="cell markdown" id="V_H2_fRKsHx6">
<p><strong>6.1.6 Lasso</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my Lasso model. These hyperparameters are the flag to specify whether the input data should be copied, the flag to specify whether the model should fit an intercept term, the flag to specify whether the model should enforce positive coefficients, the regularization strength, the maximum number of iterations to perform, and the flag to specify whether to precompute the Gram matrix. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination, using 5-fold cross-validation.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new Lasso model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the R^2 score, which is a measure of how well the model was able to predict the target variable. The R^2 score was 0.80546941, which means that the model was able to explain 80.6% of the variance in the test set.</p>
</div>
<div class="cell code" id="qDn4Ogo9rmQu">
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>parameters7 <span class="op">=</span> {<span class="st">&quot;copy_X&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;fit_intercept&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;positive&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;alpha&quot;</span>: np.arange(<span class="dv">5</span>),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;max_iter&quot;</span>: np.arange(<span class="dv">5</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;precompute&quot;</span>: [<span class="va">True</span>, <span class="va">False</span>]}</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>grid_Lasso<span class="op">=</span>GridSearchCV(Lasso(),parameters7,cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>grid_Lasso.fit(X_train,y_train)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>grid_Lasso.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="68" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ZnFxEhbbr4ib" data-outputId="05e508f8-5854-4d73-8c5a-65805158ef2a">
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>best_Lasso<span class="op">=</span>Lasso(<span class="op">**</span>grid_Lasso.best_params_)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>best_Lasso.fit(X_train,y_train)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/linear_model/_coordinate_descent.py:633: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Duality gap: 35287511342.25635, tolerance: 403655037.33333343
  model = cd_fast.enet_coordinate_descent_gram(
</code></pre>
</div>
<div class="output execute_result" data-execution_count="68">
<pre><code>Lasso(alpha=4, max_iter=4, positive=True, precompute=True)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="7IsCl0OKr-a3" data-outputId="7a92a187-613e-49ca-f92a-d91bcccf4949">
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pred_Lasso<span class="op">=</span>best_Lasso.predict(X_test)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(y_test, pred_Ridge)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>ax.plot([y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], [y.<span class="bu">min</span>(), y.<span class="bu">max</span>()], <span class="st">&#39;k--&#39;</span>, lw<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#regression line</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>pred_Lasso<span class="op">=</span> pred_Lasso.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>y_test_lasso <span class="op">=</span> y_test.values.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>ax.plot(y_test_lasso, best_RFG.fit(y_test_lasso, pred_Lasso).predict(y_test_lasso))</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;R2: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(r2_score(y_test_lasso,  pred_Lasso)))</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-69-16264ac1aacc&gt;:10: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  ax.plot(y_test_lasso, best_RFG.fit(y_test_lasso, pred_Lasso).predict(y_test_lasso))
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/6a091ee690fd3ec9e9fefa0e576027d65dc1267e.png" /></p>
</div>
</div>
<div class="cell markdown" id="u5rcOZkCvFH5">
<p>Here, I compare the r2 scores of the 6 regression algorithms we work with on a graph. Gradient Boosting Regressor and Random Forest Regressor algorithms gave the most successful results. The most optimum result belongs to Gradient Boosting Regressor.</p>
</div>
<div class="cell code" data-execution_count="70" data-colab="{&quot;height&quot;:734,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="gkE711F3s5U4" data-outputId="4ff7815b-b3de-478b-8fd7-8c4d64aabede">
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>r2_GBR<span class="op">=</span>r2_score(y_test,pred_GBR)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>r2_KNN<span class="op">=</span> r2_score(y_test,pred_KNN)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>r2_RFG<span class="op">=</span>r2_score(y_test,pred_RFG)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>r2_LR<span class="op">=</span>r2_score(y_test,pred_LR)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>r2_Ridge<span class="op">=</span>r2_score(y_test,pred_Ridge)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>r2_Lasso<span class="op">=</span>r2_score(y_test,pred_Lasso)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>regressor_name <span class="op">=</span> [<span class="st">&quot;Gradient Boosting&quot;</span>,<span class="st">&quot;KNeighbors&quot;</span>,<span class="st">&quot;Random Forest&quot;</span>,<span class="st">&quot;Linear Regression&quot;</span>,<span class="st">&quot;Ridge&quot;</span>,<span class="st">&quot;Lasso&quot;</span>]</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>r2_scores <span class="op">=</span> [r2_GBR, r2_KNN, r2_RFG,r2_LR,r2_Ridge,r2_Lasso]</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>plt.bar(regressor_name, r2_scores, color <span class="op">=</span><span class="st">&#39;orange&#39;</span>, width <span class="op">=</span> <span class="fl">0.5</span>) </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Accuracy Values ​​for 6 Regressor Algorithm&quot;</span>)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Regressor&quot;</span>)</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;r2 score&quot;</span>)</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>     </span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/0dc6020f4a674edcb45709a712efc704cf0fcdcb.png" /></p>
</div>
</div>
<section id="62-classification" class="cell markdown" id="kM_QvdWkToPC">
<h1><strong>6.2 Classification</strong></h1>
<p>Here I used the classification model to decide whether the candidate was place or not place. I separate our model as 30% test and 70% train.</p>
</section>
<div class="cell code" data-execution_count="71" id="nlDbGkzoTqcd">
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;salary&#39;</span>,<span class="st">&#39;status&#39;</span>,<span class="st">&#39;sl_no&#39;</span>])</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> df[<span class="st">&#39;status&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="72" id="I7rsXrA8TqfI">
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>X1_train,X1_test,y1_train,y1_test <span class="op">=</span> train_test_split(X1, y1, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="73" id="JnGm-4eOTz1l">
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>X1_train <span class="op">=</span> scaler.fit_transform(X1_train)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>X1_test <span class="op">=</span> scaler.transform(X1_test)</span></code></pre></div>
</div>
<div class="cell markdown" id="U-EHeBmjT-P2">
<p><strong>6.2.1 KNN Classifier</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my K-nearest neighbors classifier model. These hyperparameters are the weight function to use, the size of the leaf nodes in the k-d tree used to find the nearest neighbors, the number of neighbors to use, and the distance metric to use. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new K-nearest neighbors classifier model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the accuracy score, which is a measure of how many of the predictions made by the model were correct. The accuracy score was 0.86153846, which means that the model was able to correctly classify 86.2% of the test set.</p>
</div>
<div class="cell code" data-execution_count="74" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Ww0NxnPPUA_Z" data-outputId="d43be14b-560b-45b5-d1a3-58572803a910">
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>parameters_knn<span class="op">=</span>{</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>,<span class="st">&#39;distance&#39;</span>],</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;leaf_size&#39;</span> : <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">20</span>)),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;n_neighbors&#39;</span> : <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">30</span>)),</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;metric&#39;</span> : [<span class="st">&#39;minkowski&#39;</span>,<span class="st">&#39;euclidean&#39;</span>,<span class="st">&#39;manhattan&#39;</span>]}</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>KNN_GS <span class="op">=</span> GridSearchCV(KNeighborsClassifier(),parameters_knn)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>KNN_GS.fit(X1_train,y1_train)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>KNN_GS.best_params_</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>{&#39;leaf_size&#39;: 1, &#39;metric&#39;: &#39;minkowski&#39;, &#39;n_neighbors&#39;: 8, &#39;weights&#39;: &#39;uniform&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="iqeCtErmUemf" data-outputId="961a3b9e-c086-4117-c41c-90bb58bea2f7">
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>knnc_best<span class="op">=</span>KNeighborsClassifier(<span class="op">**</span>KNN_GS.best_params_)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>knnc_best.fit(X1_train,y1_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">
<pre><code>KNeighborsClassifier(leaf_size=1, n_neighbors=8)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76" data-colab="{&quot;height&quot;:439,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fL1-yLuWUpAd" data-outputId="28920dcb-71f3-44d2-d228-aacd67ece434">
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>pred_knnc<span class="op">=</span>knnc_best.predict(X1_test)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy score for KNeighbors Classifier:&quot;</span>,accuracy_score(y1_test,pred_knnc))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>cf_matrix <span class="op">=</span> confusion_matrix(y1_test, pred_knnc)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">&#39;True Neg&#39;</span>,<span class="st">&#39;False Pos&#39;</span>,<span class="st">&#39;False Neg&#39;</span>,<span class="st">&#39;True Pos&#39;</span>]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:0.0f}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                cf_matrix.flatten()]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:.2%}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>                     cf_matrix.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(cf_matrix)]</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{v1}</span><span class="ch">\n</span><span class="sc">{v2}</span><span class="ch">\n</span><span class="sc">{v3}</span><span class="ss">&quot;</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrix, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">&#39;&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)<span class="op">;</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y1_test, pred_knnc))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for KNeighbors Classifier: 0.8615384615384616
              precision    recall  f1-score   support

           0       1.00      0.53      0.69        19
           1       0.84      1.00      0.91        46

    accuracy                           0.86        65
   macro avg       0.92      0.76      0.80        65
weighted avg       0.88      0.86      0.85        65

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/9f16121204c8105f808a57bb812fe7e0463c47a4.png" /></p>
</div>
</div>
<div class="cell markdown" id="nZlBTl6CVVop">
<p><strong>6.2.2 Decision Tree Classifier</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my decision tree classifier model. These hyperparameters are the criterion to use for splitting the nodes, the maximum depth of the tree, and the minimum number of samples required to split an internal node. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new decision tree classifier model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the accuracy score, which is a measure of how many of the predictions made by the model were correct. The accuracy score was 0.76923076, which means that the model was able to correctly classify 76.9% of the test set.</p>
</div>
<div class="cell code" id="ndOnM7ncVW9J">
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>params_dtc<span class="op">=</span>{</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;criterion&quot;</span> : [<span class="st">&#39;gini&#39;</span>,<span class="st">&#39;entropy&#39;</span>],</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;max_depth&quot;</span> : <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;min_samples_split&quot;</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>dtc_mod <span class="op">=</span> GridSearchCV(DecisionTreeClassifier(),params_dtc)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>dtc_mod.fit(X1_train,y1_train)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>dtc_mod.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="78" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="4odm-3DrVfG-" data-outputId="5e6bed19-0044-4457-abe1-6cab0472262c">
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dtc_best<span class="op">=</span>DecisionTreeClassifier(<span class="op">**</span>dtc_mod.best_params_)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>dtc_best.fit(X1_train,y1_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="78">
<pre><code>DecisionTreeClassifier(criterion=&#39;entropy&#39;, max_depth=3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="79" data-colab="{&quot;height&quot;:439,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="D6AXg1i2VpPD" data-outputId="237dd5d2-e898-469c-d137-b6219504da1b">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>pred_dtc<span class="op">=</span>dtc_best.predict(X1_test)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy score for Decision Tree Classifier:&quot;</span>,accuracy_score(y1_test,pred_dtc))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>cf_matrix2 <span class="op">=</span> confusion_matrix(y1_test, pred_dtc)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">&#39;True Neg&#39;</span>,<span class="st">&#39;False Pos&#39;</span>,<span class="st">&#39;False Neg&#39;</span>,<span class="st">&#39;True Pos&#39;</span>]</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:0.0f}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                cf_matrix.flatten()]</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:.2%}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                     cf_matrix.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(cf_matrix)]</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{v1}</span><span class="ch">\n</span><span class="sc">{v2}</span><span class="ch">\n</span><span class="sc">{v3}</span><span class="ss">&quot;</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrix2, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">&#39;&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)<span class="op">;</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y1_test, pred_dtc))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for Decision Tree Classifier: 0.7692307692307693
              precision    recall  f1-score   support

           0       0.64      0.47      0.55        19
           1       0.80      0.89      0.85        46

    accuracy                           0.77        65
   macro avg       0.72      0.68      0.70        65
weighted avg       0.76      0.77      0.76        65

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/4273e1c5e5a48bf4e18342a7f300a231e492be0e.png" /></p>
</div>
</div>
<div class="cell markdown" id="B3tK3UJmV1rd">
<p><strong>6.2.3 Gradient Boosting Classifier</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my gradient boosting classifier model. These hyperparameters are the number of trees in the model, the minimum number of samples required to split an internal node, and the minimum number of samples required to be at a leaf node. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new gradient boosting classifier model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the accuracy score, which is a measure of how many of the predictions made by the model were correct. The accuracy score was 0.78461538, which means that the model was able to correctly classify 78.5% of the test set.</p>
</div>
<div class="cell code" id="7bKBUe7xV4ch">
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>parameters_gbc <span class="op">=</span> {</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;n_estimators&quot;</span> : [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>,<span class="dv">512</span>],</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;min_samples_split&quot;</span> : <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>)),</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;min_samples_leaf&quot;</span>:  <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>gbc_mod <span class="op">=</span> GridSearchCV(GradientBoostingClassifier(),parameters_gbc)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>gbc_mod.fit(X1_train,y1_train)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>gbc_mod.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="81" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="iCjsE3T3WA71" data-outputId="5c6819ca-260f-40da-a2cb-ef449721c0d3">
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>gbc_best<span class="op">=</span>GradientBoostingClassifier(<span class="op">**</span>gbc_mod.best_params_)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>gbc_best.fit(X1_train,y1_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="81">
<pre><code>GradientBoostingClassifier(min_samples_leaf=6, n_estimators=32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="82" data-colab="{&quot;height&quot;:443,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="kOiKQnY4WJ8F" data-outputId="d926e0ae-6b53-49ea-83e9-a4aaac800a1c">
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pred_gbc<span class="op">=</span>gbc_best.predict(X1_test)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy score for Gradient Boosting Classifier:&quot;</span>,accuracy_score(y1_test,pred_gbc))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>cf_matrix3 <span class="op">=</span> confusion_matrix(y1_test, pred_gbc)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">&#39;True Neg&#39;</span>,<span class="st">&#39;False Pos&#39;</span>,<span class="st">&#39;False Neg&#39;</span>,<span class="st">&#39;True Pos&#39;</span>]</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:0.0f}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                cf_matrix.flatten()]</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:.2%}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>                     cf_matrix.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(cf_matrix)]</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{v1}</span><span class="ch">\n</span><span class="sc">{v2}</span><span class="ch">\n</span><span class="sc">{v3}</span><span class="ss">&quot;</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrix3, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">&#39;&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)<span class="op">;</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y1_test, pred_gbc))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for Gradient Boosting Classifier: 0.7846153846153846
              precision    recall  f1-score   support

           0       0.65      0.58      0.61        19
           1       0.83      0.87      0.85        46

    accuracy                           0.78        65
   macro avg       0.74      0.72      0.73        65
weighted avg       0.78      0.78      0.78        65

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/b962488539371c670ce93d2479d6591fd1682230.png" /></p>
</div>
</div>
<div class="cell markdown" id="e3WJzQ_SlVqk">
<p><strong>6.2.4 Logistic Regression</strong></p>
<p>In this code, I defined a dictionary of hyperparameters that I wanted to tune for my logistic regression model. These hyperparameters are the penalty function to use, the inverse of the regularization strength, and the solver to use. I then used grid search cross-validation to find the best combination of these hyperparameters by training and evaluating a model for each possible combination.</p>
<p>After fitting the grid search object to my training data, I accessed the best combination of hyperparameters found by the grid search and used it to create a new logistic regression model. I fit this model to my training data and used it to make predictions on my test set. Finally, I calculated the accuracy score, which is a measure of how many of the predictions made by the model were correct. The accuracy score was 0.83076923, which means that the model was able to correctly classify 83.8% of the test set.</p>
</div>
<div class="cell code" id="kxFMcmW0W_Dm">
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>parameters_log <span class="op">=</span> {</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;penalty&#39;</span> : [<span class="st">&#39;l1&#39;</span>,<span class="st">&#39;l2&#39;</span>], </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>       : np.logspace(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">7</span>),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;solver&#39;</span>  : [<span class="st">&#39;newton-cg&#39;</span>, <span class="st">&#39;lbfgs&#39;</span>, <span class="st">&#39;liblinear&#39;</span>],</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>logr_mod <span class="op">=</span> GridSearchCV(LogisticRegression(),parameters_log)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>logr_mod.fit(X1_train,y1_train)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>logr_mod.best_params_</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="84" data-colab="{&quot;height&quot;:0,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="oQWeapGhXwfY" data-outputId="d29d724f-3236-4f70-b425-6d984277cd0b">
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>logr_best <span class="op">=</span> LogisticRegression(<span class="op">**</span>logr_mod.best_params_)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>logr_best.fit(X1_train,y1_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="84">
<pre><code>LogisticRegression(C=0.1, solver=&#39;newton-cg&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="85" data-colab="{&quot;height&quot;:439,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Ekb_-J6TYECQ" data-outputId="238e4f0f-2115-42f2-e16c-899b03e8bdf9">
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>pred_logr<span class="op">=</span>logr_best.predict(X1_test)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy score for Logistic Regression:&quot;</span>,accuracy_score(y1_test,pred_logr))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>cf_matrix4 <span class="op">=</span> confusion_matrix(y1_test, pred_logr)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">&#39;True Neg&#39;</span>,<span class="st">&#39;False Pos&#39;</span>,<span class="st">&#39;False Neg&#39;</span>,<span class="st">&#39;True Pos&#39;</span>]</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:0.0f}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                cf_matrix.flatten()]</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">&quot;</span><span class="sc">{0:.2%}</span><span class="st">&quot;</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>                     cf_matrix.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(cf_matrix)]</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{v1}</span><span class="ch">\n</span><span class="sc">{v2}</span><span class="ch">\n</span><span class="sc">{v3}</span><span class="ss">&quot;</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrix4, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">&#39;&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)<span class="op">;</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y1_test, pred_logr))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for Logistic Regression: 0.8307692307692308
              precision    recall  f1-score   support

           0       0.79      0.58      0.67        19
           1       0.84      0.93      0.89        46

    accuracy                           0.83        65
   macro avg       0.81      0.76      0.78        65
weighted avg       0.83      0.83      0.82        65

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/7d7f2e3ef302a06f6798bb2a744cfe47aec25b6c.png" /></p>
</div>
</div>
<div class="cell markdown" id="zgvOpTUJzNkm">
<p>Here, we compare the accuracy values ​​of the 4 classification algorithms we used in the hiring decision with a graph. The algorithm that gives the most appropriate percentage of accuracy to my model is the Logistic Regression algorithm.</p>
</div>
<div class="cell code" data-execution_count="86" data-colab="{&quot;height&quot;:821,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="84Adb9hfyDdQ" data-outputId="ade0b3f6-4b1f-4ed3-d419-e8f91063664a">
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>acc_knn <span class="op">=</span> accuracy_score(y1_test,pred_knnc)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acc_knn)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>acc_dc <span class="op">=</span> accuracy_score(y1_test,pred_dtc)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acc_dc)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>acc_gb <span class="op">=</span> accuracy_score(y1_test,pred_gbc)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acc_gb)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>acc_logr <span class="op">=</span> accuracy_score(y1_test,pred_logr)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acc_logr)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>classifier_name <span class="op">=</span> [<span class="st">&quot;KNeighbors&quot;</span>,<span class="st">&quot;Decision Tree&quot;</span>,<span class="st">&quot;Gradient Boosting&quot;</span>,<span class="st">&quot;Logistic Regression&quot;</span>]</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>accuracy_scores <span class="op">=</span> [acc_knn, acc_dc, acc_gb,acc_logr]</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>plt.bar(classifier_name, accuracy_scores, color <span class="op">=</span><span class="st">&#39;orange&#39;</span>, width <span class="op">=</span> <span class="fl">0.5</span>) </span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Accuracy Values ​​for 4 Classifier Algorithm&quot;</span>)</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Classifier&quot;</span>)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Accuracy&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.8615384615384616
0.7692307692307693
0.7846153846153846
0.8307692307692308
</code></pre>
</div>
<div class="output execute_result" data-execution_count="86">
<pre><code>Text(0, 0.5, &#39;Accuracy&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_56a17a6702164a7cbedcc9f8bae4fce8/0c417f42d39fa2cd71db4d2be3f501f60e1d3d75.png" /></p>
</div>
</div>
<section id="6-results-and-discussion" class="cell markdown" id="r5yR7wD1_QRZ">
<h1><strong>6. Results and Discussion</strong></h1>
<p>Gradient Boosting Regressor, KNeighbors Regressor, Random Forest Regressor, Linear Regression, Ridge and Lasso were used for salary prediction. The optimum result was achieved with Gradient Boosting Regressor. The r2 score value is 86.2%. KNN Classifier, Decision Tree Classifier, Gradient Boosting Classifier and Logistic Regression were used while deciding on the recruitment of the candidate. The most successful model was achieved with KNeigbors Classifier with 86.2% accuracy. More successful models can be obtained with different parameters by increasing the number of parameters with more powerful devices.</p>
</section>
<section id="7-conclusion-and-future-works" class="cell markdown" id="U_a1Mm166lwH">
<h1><strong>7. Conclusion and Future Works</strong></h1>
<p>In this project, the regression and classification problem was solved in order to speed up the recruitment processes of the human resources unit and to offer a fair salary to the newly graduated candidates by using various algorithms.</p>
<p>Gradient Boosting Regressor algorithm gave the best result with 86.2%. For Classification, 86.2% KNeigbors gave the best result.</p>
<p>Project inputs can be updated in line with the needs of the companies and new outputs can be obtained. For example, for a software company, various factors such as the candidate's age, grade point average, algorithm exam score, technical interview exam score can be taken into account. A salary proposal can be presented by evaluating these inputs within the framework of certain weights. Company employees can also be regularly evaluated within the framework of certain exams, and company personnel salaries can be updated, thus increasing the quality of the company by ensuring that the company is more proactive.</p>
</section>
<section id="8-references" class="cell markdown" id="mrRIImO64Ic0">
<h1><strong>8. References</strong></h1>
<p>[<strong>1</strong>]Chen, S., &amp; Chen, H. (2017). A machine learning approach to predict the success of job candidates. Expert Systems with Applications, 79, 199-209.</p>
<p>[<strong>2</strong>]Chen, S., &amp; Chen, H. (2016). A machine learning approach to predict the success of job candidates based on language used in job advertisements and resumes. Computers in Human Behavior, 63, 707-717.</p>
<p>[<strong>3</strong>]Breaugh, J. A., &amp; Starke, M. A. (2012). Predicting job performance: A meta-analysis of the validity of selection procedures. Personnel Psychology, 65(1), 121-165.</p>
<p>[<strong>4</strong>]Arjundattaraju. (2022, April 22). Recruiment. Kaggle. Retrieved December 25, 2022, from <a href="https://www.kaggle.com/code/arjundattaraju/campusplacement-regressn-classifacatn#Feature-Engineering" class="uri">https://www.kaggle.com/code/arjundattaraju/campusplacement-regressn-classifacatn#Feature-Engineering</a></p>
</section>
</body>
</html>
